/* ── CSS Custom Properties ─────────────────────────────── */
:root {
  --color-complete: #4ade80;
  --color-started: #facc15;
  --color-notstarted: #94a3b8;
  --color-planning: #a78bfa;
  --color-blocked: #f87171;

  --bg-primary: #0f172a;
  --bg-secondary: #1e293b;
  --bg-tertiary: #334155;
  --text-primary: #f8fafc;
  --text-secondary: #e2e8f0;
  --text-tertiary: #cbd5e1;
  --text-muted: #94a3b8;
  --text-dimmed: #64748b;
  --border-color: #334155;
  --border-subtle: rgba(148, 163, 184, 0.15);
  --accent-green: #4ade80;
  --accent-green-dark: #0f172a;
  --toolbar-bg: rgba(15, 23, 42, 0.85);
  --sidebar-bg: rgba(15, 23, 42, 0.92);
  --hover-bg: rgba(148, 163, 184, 0.08);
  --hover-bg-strong: rgba(148, 163, 184, 0.1);
  --focus-ring: #38bdf8;
  --legend-bg: rgba(15, 23, 42, 0.9);
  --hint-bg: rgba(15, 23, 42, 0.7);
  --disabled-bg: #475569;

  /* Status dark variants (node fills) */
  --color-complete-dark: #2d8f53;
  --color-started-dark: #b8930e;
  --color-notstarted-dark: #3d4a5c;
  --color-planning-dark: #856fc8;
  --color-blocked-dark: #c65a5a;

  /* UI chrome */
  --color-root-ring: #f59e0b;
  --color-edge: #475569;
  --color-edge-dim: #64748b;
  --color-node-text-dark: #1e293b;
  --color-node-text-light: #e2e8f0;
  --color-text-shadow: rgba(0, 0, 0, 0.7);
  --color-tooltip-shadow: rgba(0, 0, 0, 0.4);

  /* Error colors */
  --color-error: #f87171;
  --color-error-text: #fca5a5;
  --color-error-bg: rgba(248, 113, 113, 0.08);
  --color-error-border: rgba(248, 113, 113, 0.3);

  /* Accent */
  --color-accent-hover: rgba(74, 222, 128, 0.08);
  --color-accent-active: rgba(74, 222, 128, 0.1);
  --color-accent-subtle: rgba(74, 222, 128, 0.05);
  --color-code-bg: rgba(255, 255, 255, 0.05);
  --color-spinner-border: rgba(255, 255, 255, 0.3);
  --color-spinner-track: rgba(255, 255, 255, 0.05);
  --color-strata-line: rgba(148, 163, 184, 0.45);

  /* Vine edge colors */
  --color-vine: #6b4f6b;
  --color-vine-leaf: #5a7a5a;

  /* Glass node effects */
  --color-glass-highlight: rgba(255, 255, 255, 0.28);
  --color-glass-highlight-soft: rgba(255, 255, 255, 0.08);
  --color-glass-inner-shadow: rgba(0, 0, 0, 0.35);

  color-scheme: dark;
}

[data-theme='light'] {
  --bg-primary: #f8fafc;
  --bg-secondary: #f1f5f9;
  --bg-tertiary: #e2e8f0;
  --text-primary: #0f172a;
  --text-secondary: #1e293b;
  --text-tertiary: #475569;
  --text-muted: #64748b;
  --text-dimmed: #94a3b8;
  --border-color: #cbd5e1;
  --border-subtle: rgba(100, 116, 139, 0.35);
  --accent-green: #16a34a;
  --accent-green-dark: #ffffff;
  --toolbar-bg: rgba(248, 250, 252, 0.85);
  --sidebar-bg: rgba(248, 250, 252, 0.95);
  --hover-bg: rgba(100, 116, 139, 0.08);
  --hover-bg-strong: rgba(100, 116, 139, 0.15);
  --focus-ring: #0284c7;
  --legend-bg: rgba(248, 250, 252, 0.92);
  --hint-bg: rgba(248, 250, 252, 0.8);
  --disabled-bg: #94a3b8;

  /* Status dark variants (node fills) - lighter for light theme */
  --color-complete-dark: #4ade80;
  --color-started-dark: #eab308;
  --color-notstarted-dark: #b0bec5;
  --color-planning-dark: #a78bfa;
  --color-blocked-dark: #f87171;

  /* UI chrome */
  --color-root-ring: #d97706;
  --color-edge: #94a3b8;
  --color-edge-dim: #cbd5e1;
  --color-node-text-dark: #1e293b;
  --color-node-text-light: #ffffff;
  --color-text-shadow: rgba(0, 0, 0, 0.3);
  --color-tooltip-shadow: rgba(0, 0, 0, 0.2);
  --color-strata-line: rgba(71, 85, 105, 0.45);

  /* Vine edge colors */
  --color-vine: #2e8b57;
  --color-vine-leaf: #3a7a3a;

  /* Glass node effects */
  --color-glass-highlight: rgba(255, 255, 255, 0.4);
  --color-glass-highlight-soft: rgba(255, 255, 255, 0.12);
  --color-glass-inner-shadow: rgba(0, 0, 0, 0.15);

  /* Error colors */
  --color-error: #ef4444;
  --color-error-text: #dc2626;
  --color-error-bg: rgba(239, 68, 68, 0.08);
  --color-error-border: rgba(239, 68, 68, 0.3);

  /* Accent */
  --color-accent-hover: rgba(22, 163, 74, 0.08);
  --color-accent-active: rgba(22, 163, 74, 0.12);
  --color-accent-subtle: rgba(22, 163, 74, 0.05);
  --color-code-bg: rgba(0, 0, 0, 0.05);
  --color-spinner-border: rgba(0, 0, 0, 0.3);
  --color-spinner-track: rgba(0, 0, 0, 0.05);

  color-scheme: light;
}

/* ── Base Reset ───────────────────────────────────────── */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body,
#app {
  height: 100%;
  margin: 0;
  padding: 0;
}

body {
  overflow: hidden;
  background: var(--bg-primary);
  color: var(--text-secondary);
  font-family:
    system-ui,
    -apple-system,
    'Segoe UI',
    Roboto,
    'Helvetica Neue',
    Arial,
    sans-serif;
}

button,
input,
select,
textarea {
  font-family: inherit;
}

:focus-visible {
  outline: 2px solid var(--focus-ring);
  outline-offset: 2px;
}

/* ── Status Classes ───────────────────────────────────── */
.status-complete {
  fill: var(--color-complete);
  stroke: var(--color-complete);
}

.status-started {
  fill: var(--color-started);
  stroke: var(--color-started);
}

.status-notstarted {
  fill: var(--color-notstarted);
  stroke: var(--color-notstarted);
}

.status-planning {
  fill: var(--color-planning);
  stroke: var(--color-planning);
}

.status-blocked {
  fill: var(--color-blocked);
  stroke: var(--color-blocked);
}

/* ── Keyframe Animations ──────────────────────────────── */

/* Gentle vertical oscillation for node labels */
@keyframes label-bob {
  0%,
  100% {
    transform: translateY(-2px);
  }
  50% {
    transform: translateY(2px);
  }
}

/* Outer glow ring pulse for "started" nodes */
@keyframes glow-pulse {
  0%,
  100% {
    opacity: 0.4;
  }
  50% {
    opacity: 0.8;
  }
}

/* Rotating radial gradient shimmer for "complete" nodes */
/* SVG-compatible shimmer: subtle brightness pulse for complete nodes */
@keyframes completion-shimmer {
  0%,
  100% {
    filter: brightness(1);
  }
  50% {
    filter: brightness(1.3);
  }
}

/* Flowing dots along edges — 60px dashoffset over 2s = 30px/s */
@keyframes edge-flow {
  from {
    stroke-dashoffset: 60;
  }
  to {
    stroke-dashoffset: 0;
  }
}

/* Horizontal shake for error cards — 3 cycles in 300ms */
@keyframes error-shake {
  0%,
  100% {
    transform: translateX(0);
  }
  16.6% {
    transform: translateX(-4px);
  }
  33.3% {
    transform: translateX(4px);
  }
  50% {
    transform: translateX(-4px);
  }
  66.6% {
    transform: translateX(4px);
  }
  83.3% {
    transform: translateX(-4px);
  }
}

/* Gentle sway for vine leaf decorations */
@keyframes vine-leaf-sway {
  0%,
  100% {
    transform: rotate(-3deg);
  }
  50% {
    transform: rotate(3deg);
  }
}

/* ── Animation Utility Classes ────────────────────────── */
.anim-label-bob {
  /* animation removed — continuous translateY + will-change caused GPU-layer
     rasterisation that destroyed SVG vector-text clarity (blurry labels) */
}

.anim-glow-pulse {
  animation: glow-pulse 2s ease-in-out infinite;
}

.anim-completion-shimmer {
  animation: completion-shimmer 6s linear infinite;
}

.anim-edge-flow {
  animation: edge-flow 2s linear infinite;
}

.anim-vine-leaf-sway {
  animation: vine-leaf-sway 4s ease-in-out infinite;
  transform-origin: 0% 50%;
}

.anim-vine-tendril-sway {
  animation: vine-tendril-sway 5s ease-in-out infinite;
  transform-origin: 0 0;
}

@keyframes vine-tendril-sway {
  0%,
  100% {
    transform: rotate(-5deg);
  }
  50% {
    transform: rotate(5deg);
  }
}

.anim-error-shake {
  animation: error-shake 300ms ease-in-out;
}

/* ── Reduced Motion ───────────────────────────────────── */
@media (prefers-reduced-motion: reduce) {
  .anim-label-bob,
  .anim-glow-pulse,
  .anim-completion-shimmer,
  .anim-edge-flow,
  .anim-vine-leaf-sway,
  .anim-vine-tendril-sway,
  .anim-error-shake {
    animation: none !important;
  }
}
